<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>New Hacker Tab</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" type="image/png" href="/img/favicon-32x32.png?v=1.0">
		<link rel="stylesheet" href="css/spectre.min.css">
		<link rel="stylesheet" href="css/spectre-exp.min.css">
		<link rel="stylesheet" href="css/spectre-icons.min.css">
		<style type="text/css" media="screen">
#change-view {
	display:none;
}
#editor-button {
	position: fixed;
	bottom: 10px;
	right: 10px;
	z-index: 1000;
}
#editor {
	position: absolute;
	top: 56px;
	right: 0px;
	bottom: 0px;
	left: 0px;
	background: #fff;
}
.navbar {
	padding: 10px;
}
		</style>
	</head>
	<body>
		<div id="content-view">
			<button id="editor-button" class="btn btn-action s-circle" onclick="toggle()"><i class="icon icon-edit"></i></button>
			<div id="content"></div>
		</div>
		<div id="change-view">
			<header class="navbar">
				<section class="navbar-section">
					<a href="https://www.new-hacker-tab.com" class="navbar-brand mr-2">New-Hacker-Tab.com</a>
				</section>
				<section class="navbar-center">
					<!-- centered logo or brand -->
				</section>
				<section class="navbar-section">
					<label class="form-switch">
						<input type="checkbox" id="vim-checkbox" onChange="toggleKeys()">
						<i class="form-icon"></i> Vim Keys
					</label>
					<div class="btn-group btn-group-block">
						<a href="#" class="btn" onclick="importFile()">Import</a>
						<a href="#" class="btn" onclick="exportFile()">Export</a>
					</div>
					<a href="#" class="btn btn-link" onclick="reset()">Reset</a>
					<div class="btn-group btn-group-block">
						<a href="#" class="btn" onclick="cancel()">Cancel</a>
						<a href="#" class="btn active" onclick="save()">Save</a>
					</div>
				</section>
			</header>
			<div id="editor"></div>
		</div>
		<a id="hiddenDownloadHelper" style="display:none;"></a>

		<script src="js/jquery-3.3.1.min.js"></script>
		<script src="js/localforage.min.js"></script>
		<script src="js/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
		<script>
// NOTE: using a base64 string here to avoid conflicts with script tags
var defaultStr='eyJjb2RlIjoiPHN0eWxlPlxuXHQvKiBiYWNrZ3JvdW5kLWltZyAqL1xuXHRib2R5IHtcblx0XHRiYWNrZ3JvdW5kOiAjZjZmNmY2O1xuXHR9XG5cdEBtZWRpYSAobWluLXdpZHRoOiA5NjBweCkge1xuICAgIFx0aHRtbCB7XG4gICAgXHRcdG1pbi1oZWlnaHQ6IDEwMCU7XG4gICAgXHR9XG4gICAgXHRib2R5IHtcbiAgICBcdFx0bWluLWhlaWdodDogMTAwJTtcbiAgICBcdFx0YmFja2dyb3VuZC1hdHRhY2htZW50OiBmaXhlZDtcbiAgICBcdFx0YmFja2dyb3VuZC1pbWFnZTogdXJsKCcvaW1nL2JhY2tncm91bmRfMDEuanBnJyk7XG4gICAgXHRcdGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gICAgXHRcdGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG4gICAgXHR9XG5cdH1cblxuXHQvKiBncmlkLWxheW91dCAqL1xuICAgIC5ncmlkLWNvbnRhaW5lciB7XG5cdFx0bWFyZ2luOiAxNnB4O1xuXHRcdHRleHQtYWxpZ246IGxlZnQ7XG4gICAgXHRkaXNwbGF5OiBncmlkO1xuICAgIFx0Z3JpZC1nYXA6IDEwcHg7XG4gICAgfVxuXHRAbWVkaWEgKG1heC13aWR0aDogOTU5cHgpIHtcbiAgICBcdC5ncmlkLWNvbnRhaW5lciB7XG4gICAgXHRcdGdyaWQtdGVtcGxhdGUtYXJlYXM6XG4gICAgXHRcdFx0J3NlYXJjaCdcbiAgICBcdFx0ICAgICdjZW50ZXInXG4gICAgXHRcdFx0J2xlZnQnXG4gICAgXHRcdCAgICAncmlnaHQnO1xuICAgIFx0fVxuICAgIH1cblx0QG1lZGlhIChtaW4td2lkdGg6IDk2MHB4KSB7XG4gICAgXHQuZ3JpZC1jb250YWluZXIge1xuICAgIFx0XHRncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDMwMHB4IGF1dG8gMzAwcHg7XG4gICAgXHRcdGdyaWQtdGVtcGxhdGUtYXJlYXM6XG4gICAgXHRcdFx0J3NlYXJjaCBzZWFyY2ggc2VhcmNoJ1xuICAgIFx0XHRcdCdsZWZ0IGNlbnRlciByaWdodCc7XG4gICAgXHR9XG4gICAgfVxuXHQuc2VhcmNoIHtcblx0XHRncmlkLWFyZWE6IHNlYXJjaFxuXHR9XG5cdC5sZWZ0IHtcblx0XHRncmlkLWFyZWE6IGxlZnRcblx0fVxuXHQucmlnaHQge1xuXHRcdGdyaWQtYXJlYTogcmlnaHRcblx0fVxuXHQubm90ZXMge1xuXHRcdGdyaWQtYXJlYTogY2VudGVyO1xuXHRcdG1hcmdpbi10b3A6IDRweDtcblx0fVxuXHQud2lkZ2V0IHtcblx0ICAgIG1hcmdpbi1ib3R0b206IDEycHg7XG5cdH1cblxuXHQvKiBVbmNvbW1lbnQgaWYgeW91IHdhbnQgdG8gaGlkZSB0aGUgZWRpdCBidXR0b24gKi9cblx0LyojZWRpdG9yLWJ1dHRvbiB7XG5cdG9wYWNpdHk6IDAuMDAxO1xuXHR9XG5cdCNlZGl0b3ItYnV0dG9uOmhvdmVyIHtcblx0XHRvcGFjaXR5OiAxLjA7XG5cdH0qL1xuPC9zdHlsZT5cblxuPGRpdiBjbGFzcz1cImdyaWQtY29udGFpbmVyXCI+XG5cdDwhLS0gc2VhcmNoIC0tPlxuXHQ8ZGl2IGNsYXNzPVwic2VhcmNoIHdpZGdldFwiPlxuXHRcdDxzY3JpcHQ+XG5cdFx0XHQvLyBmb2N1cyB0aGUgc2VhcmNoIGJhciBvbiBsb2FkXG5cdFx0XHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xuXHRcdFx0XHQkKFwiI3NlYXJjaC1pbnB1dFwiKS5mb2N1cygpXG5cdFx0XHR9KVxuXG5cdFx0XHQvLyB0aGlzIGZ1bmN0aW9uIGlzIGJlaW5nIGNhbGxlZCB3aGVuIHRoZSBzZWFyY2ggYmFyIGZvcm0gaXMgYmVpbmcgc3VibWl0dGVkXG5cdFx0XHRmdW5jdGlvbiBzZWFyY2goKSB7XG5cdFx0XHRcdC8vIGdldCB0aGUgc2VhcmNoIHN0cmluZ1xuXHRcdFx0XHRzZWFyY2hTdHI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2gtaW5wdXRcIikudmFsdWVcblxuXHRcdFx0XHQvLyBjb3VudCB0aGUgd29yZHMgc2VwYXJhdGVkIGJ5IHNwYWNlc1xuXHRcdFx0XHRudW1iZXJPZldvcmRzPShzZWFyY2hTdHIuc3BsaXQoXCIgXCIpLmxlbmd0aClcblxuXHRcdFx0XHRpZihzZWFyY2hTdHIubWF0Y2goL15bXlxcLiBdKlxcLlteXFwvIF0qLykgIT09IG51bGwpIHtcblx0XHRcdFx0XHQvLyBpZiB0aGUgZmlyc3QgcGFydCBsb29rcyBsaWtlIGEgZG9tYWluLCBqdXN0IGdvIGZvciBpdFxuXHRcdFx0XHRcdGxvY2F0aW9uLmhyZWY9XCJodHRwczovL1wiICsgc2VhcmNoU3RyXG5cdFx0XHRcdH0gZWxzZSBpZiAobnVtYmVyT2ZXb3JkcyA9PSAxKSB7XG5cdFx0XHRcdFx0Ly8gZWxzZSBpZiBpdCBpcyBqdXN0IG9uZSB3b3JkIHVzZSBhIGRpY3Rpb25hcnkgbGlrZSBsaW5ndWVlXG5cdFx0XHRcdFx0bG9jYXRpb24uaHJlZj1cImh0dHBzOi8vd3d3Lmxpbmd1ZWUuY29tL3NlYXJjaD9xdWVyeT1cIiArIGVuY29kZVVSSShzZWFyY2hTdHIpXG5cdFx0XHRcdFx0Ly8gb3IgZGljdC5jY1xuXHRcdFx0XHRcdC8vIGxvY2F0aW9uLmhyZWY9XCJodHRwczovL2RpY3QuY2MvP3M9XCIgKyBlbmNvZGVVUkkoc2VhcmNoU3RyKVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIGVsc2UgdXNlIGR1Y2tkdWNrZ29cblx0XHRcdFx0XHRsb2NhdGlvbi5ocmVmPVwiaHR0cHM6Ly9kdWNrZHVja2dvLmNvbS8/cT1cIiArIGVuY29kZVVSSShzZWFyY2hTdHIpXG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjYW5jZWwgdGhlIGZvcm0gc3VibWlzc2lvblxuXHRcdFx0XHRyZXR1cm4gZmFsc2Vcblx0XHRcdH1cblx0XHQ8L3NjcmlwdD5cblx0XHQ8c3R5bGU+XG5cdFx0XHQuaGVybyB7XG5cdFx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdH1cblx0XHQ8L3N0eWxlPlxuXHRcdDxkaXYgY2xhc3M9XCJoZXJvXCI+XG5cdFx0XHQ8ZGl2IGNsYXM9XCJoZXJvLWJvZHlcIj5cblx0XHRcdFx0PGgxPldlbGNvbWUgSG9tZTwvaDE+XG5cdFx0XHRcdDxmb3JtIGNsYXNzPVwiaW5wdXQtZ3JvdXAgaW5wdXQtaW5saW5lXCIgb25zdWJtaXQ9XCJzZWFyY2goKVwiIHN0eWxlPVwid2lkdGg6IDgwJTsgbWF4LXdpZHRoOiA2NDBweDtcIj5cblx0XHRcdFx0XHQ8aW5wdXQgaWQ9XCJzZWFyY2gtaW5wdXRcIiBjbGFzcz1cImZvcm0taW5wdXRcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiU2VhcmNoLi4uXCI+XG5cdFx0XHRcdFx0PGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgaW5wdXQtZ3JvdXAtYnRuXCI+PGkgY2xhc3M9XCJpY29uIGljb24tc2VhcmNoXCI+PC9pPjwvYnV0dG9uPlxuXHRcdFx0XHQ8L2Zvcm0+XG5cdFx0XHQ8L2Rpdj5cblx0XHQ8L2Rpdj5cblx0PC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwibGVmdFwiPlxuICAgIFx0PCEtLSBuZXdzIC0tPlxuICAgIFx0PGRpdiBjbGFzcz1cIm5ld3Mgd2lkZ2V0XCI+XG4gICAgXHRcdDxzY3JpcHQ+XG4gICAgXHRcdFx0JC5nZXQoXCJodHRwczovL2hhY2tlci1uZXdzLmZpcmViYXNlaW8uY29tL3YwL2Jlc3RzdG9yaWVzLmpzb25cIiwgZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgXHRcdFx0XHRmb3IodmFyIGk9MDtpPDM7aSsrKSB7XG4gICAgXHRcdFx0XHRcdC8vIG9yZGVyIGlzIG5vdCBwcmVzZXJ2ZWRcbiAgICBcdFx0XHRcdFx0JC5nZXQoXCJodHRwczovL2hhY2tlci1uZXdzLmZpcmViYXNlaW8uY29tL3YwL2l0ZW0vXCIgKyBkYXRhW2ldICsgXCIuanNvblwiLCBmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICBcdFx0XHRcdFx0XHR2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIFx0XHRcdFx0XHRcdGxpLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVudS1pdGVtXCIpXG4gICAgXHRcdFx0XHRcdFx0dmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgXHRcdFx0XHRcdFx0aWYgKGRhdGEudXJsID09PSB1bmRlZmluZWQpIHtcbiAgICBcdFx0XHRcdFx0XHRcdGxpbmsuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCAnaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS9pdGVtP2lkPScgKyBkYXRhLmlkKTtcbiAgICBcdFx0XHRcdFx0XHR9IGVsc2Uge1xuICAgIFx0XHRcdFx0XHRcdFx0bGluay5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsIGRhdGEudXJsKTtcbiAgICBcdFx0XHRcdFx0XHR9XG4gICAgXHRcdFx0XHRcdFx0bGluay50ZXh0Q29udGVudCA9IGRhdGEudGl0bGVcbiAgICBcdFx0XHRcdFx0XHRsaS5hcHBlbmRDaGlsZChsaW5rKVxuICAgIFx0XHRcdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaG4tY29udGFpbmVyXCIpLmFwcGVuZENoaWxkKGxpKVxuICAgIFx0XHRcdFx0XHR9KVxuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pO1xuICAgIFx0XHQ8L3NjcmlwdD5cbiAgICBcdFx0PHN0eWxlPlxuICAgIFx0XHRcdCNobi1jb250YWluZXIgYTp2aXNpdGVkIHtcbiAgICBcdFx0XHRcdGNvbG9yOiBoc2xhKDAsIDAlLCAxMDAlLCAwLjAxKTtcbiAgICBcdFx0XHRcdGJhY2tncm91bmQ6IGhzbGEoMCwgMCUsIDEwMCUsIDAuMDEpO1xuICAgIFx0XHRcdH1cbiAgICBcdFx0PC9zdHlsZT5cbiAgICBcdFx0PHVsIGlkPVwiaG4tY29udGFpbmVyXCIgY2xhc3M9XCJtZW51IGZpcnN0LXJvd1wiIHN0eWxlPVwidGV4dC1hbGlnbjogbGVmdDtcIj5cbiAgICBcdFx0XHQ8bGkgY2xhc3M9XCJkaXZpZGVyXCIgZGF0YS1jb250ZW50PVwiQmVzdCBIYWNrZXJuZXdzXCI+PC9saT5cbiAgICBcdFx0PC91bD5cbiAgICBcdDwvZGl2PlxuICAgIFx0XG4gICAgXHQ8IS0tIGxpbmtzIC0tPlxuICAgIFx0PGRpdiBjbGFzcz1cImxpbmtzIHdpZGdldFwiPlxuICAgIFx0XHQ8dWwgY2xhc3M9XCJtZW51XCI+XG4gICAgXHRcdFx0PGxpIGNsYXNzPVwiZGl2aWRlclwiIGRhdGEtY29udGVudD1cIkxpbmtzXCI+PC9saT5cbiAgICBcdFx0XHQ8bGkgY2xhc3M9XCJtZW51LWl0ZW1cIj5cbiAgICBcdFx0XHRcdDxhIGhyZWY9XCJodHRwczovL3BpY3R1cmVwYW4yLmdpdGh1Yi5pby9zcGVjdHJlL2dldHRpbmctc3RhcnRlZC5odG1sXCI+PGkgY2xhc3M9XCJpY29uIGljb24tbGlua1wiPjwvaT4gU3BlY3RyZSBDU1M8L2E+XG4gICAgXHRcdFx0PC9saT5cbiAgICBcdFx0XHQ8bGkgY2xhc3M9XCJtZW51LWl0ZW1cIj5cbiAgICBcdFx0XHRcdDxhIGhyZWY9XCJodHRwczovL25ldy1oYWNrZXItdGFiLmNvbS9kb2NzXCI+PGkgY2xhc3M9XCJpY29uIGljb24tbGlua1wiPjwvaT4gTmV3IEhhY2tlciBUYWIgRG9jczwvYT5cbiAgICBcdFx0XHQ8L2xpPlxuICAgIFx0XHQ8L3VsPlxuICAgIFx0PC9kaXY+XG4gICAgPC9kaXY+XG4gICAgXG4gICAgPGRpdiBjbGFzcz1cInJpZ2h0XCI+XG4gICAgXHQ8IS0tIHdlYXRoZXIgLS0+XG4gICAgXHQ8ZGl2IGNsYXNzPVwid2VhdGhlciB3aWRnZXRcIj5cbiAgICBcdFx0PHVsIGlkPVwid2VhdGhlci1jb250YWluZXJcIiBjbGFzcz1cIm1lbnUgZmlyc3Qtcm93XCI+XG4gICAgXHRcdFx0PCEtLTxsaSBjbGFzcz1cImRpdmlkZXJcIiBkYXRhLWNvbnRlbnQ9XCJXZWF0aGVyIEZvcmVjYXN0XCI+PC9saT4tLT5cbiAgICBcdFx0XHQ8bGkgY2xhc3M9XCJtZW51LWl0ZW1cIj5cbiAgICBcdFx0XHRcdDwhLS0gaHR0cHM6Ly93ZWF0aGVyd2lkZ2V0LmlvLyAtLT5cbiAgICBcdFx0XHRcdDwhLS0gdGhlIGZpcnN0IHR3byBsZXR0ZXJzIGFmdGVyIHRoZSBkb21haW4gYXJlIHRoZSBsYW5ndWFnZSAtLT5cbiAgICBcdFx0XHRcdDxhIGNsYXNzPVwid2VhdGhlcndpZGdldC1pb1wiIGhyZWY9XCJodHRwczovL2ZvcmVjYXN0Ny5jb20vZW4vNDBkNzFuNzRkMDEvbmV3LXlvcmsvXCIgZGF0YS1sYWJlbF8xPVwiTkVXIFlPUktcIiBkYXRhLWxhYmVsXzI9XCJXRUFUSEVSXCIgZGF0YS1mb250PVwiUm9ib3RvXCIgZGF0YS1kYXlzPVwiM1wiID5ORVcgWU9SSyBXRUFUSEVSPC9hPlxuICAgIFx0XHRcdFx0PHNjcmlwdD5cbiAgICBcdFx0XHRcdFx0IWZ1bmN0aW9uKGQscyxpZCl7dmFyIGpzLGZqcz1kLmdldEVsZW1lbnRzQnlUYWdOYW1lKHMpWzBdO2lmKCFkLmdldEVsZW1lbnRCeUlkKGlkKSl7anM9ZC5jcmVhdGVFbGVtZW50KHMpO2pzLmlkPWlkO2pzLnNyYz0naHR0cHM6Ly93ZWF0aGVyd2lkZ2V0LmlvL2pzL3dpZGdldC5taW4uanMnO2Zqcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShqcyxmanMpO319KGRvY3VtZW50LCdzY3JpcHQnLCd3ZWF0aGVyd2lkZ2V0LWlvLWpzJyk7XG4gICAgXHRcdFx0XHQ8L3NjcmlwdD5cbiAgICBcdFx0XHQ8L2xpPlxuICAgIFx0XHQ8L3VsPlxuICAgIFx0PC9kaXY+XG4gICAgXHRcbiAgICBcdDwhLS0gYW5ub3VuY2VtZW50cyAtLT5cbiAgICBcdDxkaXYgY2xhc3M9XCJhbm5vdW5jZW1lbnRzIHdpZGdldFwiPlxuICAgIFx0XHQ8dWwgY2xhc3M9XCJtZW51XCI+XG4gICAgXHRcdFx0PGxpIGNsYXNzPVwiZGl2aWRlclwiIGRhdGEtY29udGVudD1cIkFubm91bmNlbWVudHNcIj48L2xpPlxuICAgIFx0XHRcdDxsaSBjbGFzcz1cIm1lbnUtaXRlbVwiPlxuICAgIFx0XHRcdFx0PGlmcmFtZSBzcmM9XCIvYW5ub3VuY2VtZW50cy5odG1sXCIgc3R5bGU9XCJtYXJnaW46MDsgcGFzc2luZzogMDsgd2lkdGg6IDEwMCU7IG1pbi1oZWlnaHQ6IDI0MHB4OyBib3JkZXI6bm9uZTtcIj48L2lmcmFtZT5cbiAgICBcdFx0XHQ8L2xpPlxuICAgIFx0XHQ8L3VsPlxuICAgIFx0PC9kaXY+XG4gICAgPC9kaXY+XG5cblx0PCEtLSBub3RlcyAtLT5cblx0PGRpdiBjbGFzcz1cIm5vdGVzIHdpZGdldFwiPlxuXHRcdDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L3NpbXBsZW1kZS9sYXRlc3Qvc2ltcGxlbWRlLm1pbi5jc3NcIj5cblx0XHQ8c2NyaXB0IHNyYz1cImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9zaW1wbGVtZGUvbGF0ZXN0L3NpbXBsZW1kZS5taW4uanNcIiBzeW5jPjwvc2NyaXB0PlxuXHRcdDx0ZXh0YXJlYSBpZD1cIm1hcmtkb3duLWVkaXRvclwiPjwvdGV4dGFyZWE+XG5cdFx0PHN0eWxlPlxuXHRcdFx0LkNvZGVNaXJyb3Itc2Nyb2xsIHtcblx0XHRcdFx0bWluLWhlaWdodDogNTAwcHg7XG5cdFx0XHR9XG5cdFx0XHQuZWRpdG9yLXRvb2xiYXIge1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiAjZmZmO1xuXHRcdFx0fVxuXHRcdDwvc3R5bGU+XG5cdFx0PHNjcmlwdD5cblx0XHRcdGZ1bmN0aW9uIGxvYWRNREUocmV0cmllcykge1xuXHRcdFx0XHRpZiAodHlwZW9mIFNpbXBsZU1ERSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwibG9hZGluZyBtZGUgd2l0aCBcIiArIHJldHJpZXMgKyBcIiByZXRyaWVzIGxlZnRcIilcblx0XHRcdFx0XHR2YXIgc2ltcGxlbWRlID0gbmV3IFNpbXBsZU1ERSh7XG5cdFx0XHRcdFx0XHRhdXRvc2F2ZToge1xuXHRcdFx0XHRcdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRcdFx0XHR1bmlxdWVJZDogXCJiaWdNREVcIixcblx0XHRcdFx0XHRcdFx0ZGVsYXk6IDEwMDAsXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXJrZG93bi1lZGl0b3JcIiksXG5cdFx0XHRcdFx0XHRzcGVsbENoZWNrZXI6IGZhbHNlLFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2UgaWYocmV0cmllcyA+IDApIHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGxvYWRNREUsIDIwMCwgcmV0cmllcyAtMSlcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIkZhaWxlZCBsb2FkaW5nIFNpbXBsZU1ERSwgZ2l2aW5nIHVwLlwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0bG9hZE1ERSgxMDApO1xuXHRcdDwvc2NyaXB0PlxuXHQ8L2Rpdj5cblxuPC9kaXY+XG5cbiJ9'
var defaultValue=JSON.parse(window.atob(defaultStr)).code;
var state="content"
var editor = ace.edit("editor");
editor.setTheme("ace/theme/monokai");
editor.session.setMode("ace/mode/html");
load();
document.getElementById("vim-checkbox").checked = false;

function errorReporter(err) {
	console.log(err);
	alert('An error occured. You might want to take a look at the dev-tools.')
}
function toggle(){
	if (state == "content") {
		document.getElementById("content-view").style.display = "none";
		document.getElementById("change-view").style.display = "block";
		editor.resize()
		state="editor"
	} else {
		document.getElementById("content-view").style.display = "block";
		document.getElementById("change-view").style.display = "none";
		state="content"
	}
}
function save() {
	value=editor.getValue()
	localforage.setItem("content", value).catch(errorReporter);
	render(value)
	toggle()
}
function load(){
	localforage.getItem("content").then(function(value){
		if (value == null) {
			value=defaultValue;
		}
		render(value)
		editor.session.setValue(value);
	}).catch(errorReporter);
}
function cancel(){
	if (confirm("Do you want to go back without saving and reset the the state before the editor was opened?")) {
		load()
		toggle()
	}
}
function reset(){
	if (confirm("Do you want to reset the content to the initial value and delete all customizations you made?")) {
		localforage.removeItem("content").then(function(){
			load()
		}).catch(errorReporter);
	}
}
function exportFile(){
	container={}
	container.code = editor.getValue()
	var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(container));
	var dlAnchorElem = document.getElementById('hiddenDownloadHelper');
	dlAnchorElem.setAttribute("href",     dataStr     );
	dlAnchorElem.setAttribute("download", "code-" + Date.now() + ".json");
	dlAnchorElem.click();
}
function render(html){
	// jquery executes all <script> tags accordingly
	$("#content").html(html);
}
function toggleKeys() {
	if (document.getElementById("vim-checkbox").checked) {
		editor.setKeyboardHandler('ace/keyboard/vim');
	} else {
		editor.setKeyboardHandler('ace/keyboard/ace');
	}
	editor.focus();
}
	</script>
	</body>
</html>
